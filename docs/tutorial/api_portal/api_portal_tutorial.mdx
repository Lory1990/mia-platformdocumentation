---
id: api_portal_tutorial
title: Document your services
sidebar_label: API portal documentation
---

import VideoBox from "./../../../src/components/VideoBox";

In this tutorial, we will learn how to create and use the [_API Portal_](/runtime_suite/api-portal/overview.md), a user-friendly interface that allows developers to easily visualize and test their microservices endpoints. It is built on top of the [OpenAPI 2.0](https://swagger.io/specification/v2/)/[OpenAPI 3.0](https://swagger.io/specification/) Specification. We will also use [_Swagger Aggregator_](/runtime_suite/swagger-aggregator/overview.md), a plugin that merges multiple Open Api specification documents in one place, allowing you to add documentation of new microservices without additional work.

## What we will build

We will continue the [previous tutorial](/tutorial/microservices/hello_world.mdx) adding inside the project the _API Portal_ and _Swagger Aggregator_ [plugins](/runtime_suite/mia-platform-plugins.md), from the [_Marketplace_](/marketplace/overview_marketplace.md). Also we will understand how to view the documentation testing the endpoints.

In particular, we will:

- Set up the _API Portal_ plugin;
- Set up the _Swagger Aggregator_ plugin;
- Configure the services and endpoints to be displayed in the _API Portal_;
- Open the interface and test the endpoints;

## Prerequisites

:::info
If you have already done the [previous tutorial](/tutorial/microservices/hello_world.mdx), you can skip this section.
:::

Before starting, we will assume that, you already have a clean project in Mia-Platform Console. In order to know how to create a project on Mia-Platform Console, read [this guide](/development_suite/set-up-infrastructure/create-project.mdx).

The project must:

- Be integrated with a [deploy pipeline](/development_suite/deploy/pipeline-configuration.md);
- Have an [ingress route](/paas/traefik.md) with "api-gateway" as `service`;
- Be aware of your project domains. If the project links has been configured, you can find them in the "Environments" section of the "Project Settings", under the "Application" column.

:::tip
If your are using a Mia-Platform Console in PaaS and the project has been created using the "Mia-Platform Basic Project Template", the project is already configured as needed.
:::

Moreover, you need at least:

- `developer` role on the project you want to use to reproduce the steps;
- `maintainer` role on the environment of the project you want to deploy on.

## Install plugins

In order to start the tutorial, you must be in the _design_ section of the project in the [Microservices section](/development_suite/api-console/api-design/services.md) from the left side menu.

### API Portal

The first plugin we are going to create is _API portal_, the steps to create it are:

1. Click on the _Create a Microservice_ button;
1. In the dropdown menu, select _From Marketplace_ option;
1. On the right side, you will see a catalogue of plugin, templates and examples;
1. Type **API portal** in the search bar;
1. Select the card from the list of result;
1. Click on the _Create_ button applying the default fields.
1. Save the changes by committing.

![Create API portal](img/create_api_portal.png)

### Swagger Aggregator

In case you have a project with multiple microservices, which is the most common case, it is very useful to have the ability to access their documentation from a single place. To do this, the [_Swagger Aggregator_](/runtime_suite/swagger-aggregator/overview.md) was designed, whose goal is to go and retrieve all the OpenAPI specification from each service and merge it into a single one, so that it can be shown in its entirety in the API Portal without the developer having to worry about anything else.

Used in conjunction with the Mia-Platform Console, it allows you to quickly and easily choose via a checkbox which endpoints to expose and with what degree of security, without requiring additional effort, as you will see later in the tutorial.

In order to create this plugin:

1. Click on the _Create a Microservice_ button;
1. In the dropdown menu, select _From Marketplace_ option;
1. On the right side, you will see a catalogue of plugin, templates and examples;
1. Type **Swagger Aggregator** in the search bar;
1. Select the card from the list of result;
1. Click on the _Create_ button applying the default fields.
1. Save the changes by committing.

![Create API portal](img/create_swagger_aggregator.png)

### Configure plugins endpoints

The last step needed to configure the plugins is to create the necessary endpoints that are required to make the whole process work. This consists of going to the _endpoints_ section and creating:

1. `/documentations/api-portal` pointing to "api-portal" microservice;
1. `/documentations/api-portal/api` pointing to "swagger-aggregator" microservice.

:::info
If you still don't know how to create an endpoint look at the [first tutorial](/tutorial/microservices/hello_world.mdx#expose-the-hello-world-microservice-api)!
:::

## Configure the services to be documented

Before testing the API Portal, we need to configure the services and endpoints to give the API portal the acknowledge of the services whose documentation we want.

### Configure the service

To configure the services you want to be included in the API Portal:

1. Click on the _Microservices_ section;
1. Select the service to configure, in this case _hello-world-service_;
1. Under the _details_ section fill the **API documentation path** with the service endpoint that expose the Open Api configuration, in this case `/documentation/json`;
1. Save the changes by committing.

![Configure service](img/configure_service.png)

:::caution
Be sure to remove this path from `api-gateway`, `api-portal` and `swagger-aggregator` services!
:::

### Configure the endpoint

To configure the endpoints:

1. Click on the _Endpoints_ section;
1. Select the endpoint to configure, in this case _/greetings_;
1. Under the _Endpoint settings_ section in the _Documentation_ tab check the `Show in API Portal`;
1. Save the changes by committing.

![Configure endpoint](img/configure_endpoint.png)

:::caution
Be sure to remove those flags from `/documentations/api-portal` and `/documentations/api-portal/api` endpoints!
:::

Repeat this operations for each service and endpoint you want to show in the API Portal and magically they will be added!

## Open the interface and test the endpoint

The last step is to open the API portal interface. Firstly, go to the [_environments_](/development_suite/set-up-infrastructure/runtime-environments.md) section, open the Environment's menu item and select "Go to Documentation" of the wanted environment, as shown in the image below:

![Open docs](img/open_docs.png)

After clicking the link, this interface will be displayed. Here you will find and search for each endpoint exposed by API Portal, you can also try the endpoint as you can see in the following example:

![API Portal](img/try_now_api_portal.png)
