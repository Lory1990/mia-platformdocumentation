---
id: quick_rest_api
title: Create a REST API and CRUD collection
sidebar_label: Create a Rest API and CRUD collection
---

import SourceCodeBlock from "./../../../src/components/SourceCodeBlock";

A **REST API is an application programming interface** that conforms to the constraints of REST architectural style, and allows **for interactions with RESTful web services**.
REST APIs **allow clients** (like mobile, web and other applications) **to read, write, and edit the data** of a system (like servers, databases, and many others) **hiding the implementation details** of the system itself.

In this tutorial we will see how to use **Mia-Platform Console** to **set up and expose toward the outside the cluster a REST API** to **execute CRUD operations** (Create, Read, Update, Delete) on a collection of data.

## What Weâ€™ll Build

In this tutorial we will create a CRUD collection and expose it through REST API. More specifically, we will:

<!-- SCRIVI CHE FAI LIBRERIA -->

- Set up a Crud Service;
- Create a CURD collection;
- Add fields to the collection;
- Expose the CRUD via REST API;
- Test the API through API Portal.

## Prerequisites

:::info
If you have already done the [previous tutorial](/tutorial/microservices/hello_world.mdx), you can skip this section.
:::

Before starting, we will assume that, you already have a clean project in Mia-Platform Console. In order to know how to create a project on Mia-Platform Console, read [this guide](/development_suite/set-up-infrastructure/create-project.mdx).

The project must:

- Be integrated with a [deploy pipeline](/development_suite/deploy/pipeline-configuration.md);
- Have an [ingress route](/paas/traefik.md) with "api-gateway" as `service`.
- Be aware of your project domains. If the project links has been configured, you can find them in the "Environments" section of the "Project Settings", under the "Application" column.
- Have a properly configured API Portal. If not, please follow the [previous tutorial](/tutorial/microservices/hello_world.mdx)

Better to have:

- Some familiarity with **API** and **REST** concepts. More information about API is available [here](/guidelines/rest_api_vademecum.md).

:::tip
If your are using a Mia-Platform Console in PaaS and the project has been created using the "Mia-Platform Basic Project Template", the project is already configured as needed.
:::

## Create Crud Service

The first step is to create the [Crud Service](/runtime_suite/crud-service/overview_and_usage.md) plugin, its purpose is to abstract a Data Collections allowing developers to expose CRUD APIs over the database in an easy, scalable, and secure way.
The steps are:

1. Click on the _Create a Microservice_ button;
1. In the dropdown menu, select _From Marketplace_ option;
1. On the right side, you will see a catalogue of plugin, templates and examples;
1. Type **Crud Service** in the search bar;
1. Select the card from the list of result;
1. Click on the _Create_ button applying the default fields.
1. Save the changes by committing.

## Create a new CRUD collection

After creating the Crud Service you can create a new _CRUD collection_ that contains all the information about the books of a library. To do so, you must be in the [_MongoDB CRUD_](/development_suite/api-console/api-design/crud_advanced.md) section of the project from the left side menu.

In the left area of this section you can find the button **"Create new CRUD"** and the list of all collection of the project. In our case this list is empty since we started from scratch.

To create the "books" collection:

1. Select **"Create new CRUD"**;
1. Fill the input:
   - **Name**: it is the CRUD name, in this case `books`;
   - **Internal Endpoint**: it is the endpoint exposed by the crud service, by default it is the same of the name, but it can be changed. In this case `/books`;
1. Click on the _Create_ button.
1. Save the changes to make them persistent.

![Create new MongoDB CRUD](img/MongoDB-Collection-create.png)

:::info
Remember that **two CRUDs collections or two identical endpoints (with the same path) cannot exist on the same project**. So, if you import an existing collection, you will have to choose a different name and path.
:::

## CRUD data schema

Once you have created a collection it is time to handle the schema. As you will notice the Mia-Platform Console already creates some **default fields that can not be changed** because they are necessary for the proper functioning of the CRUD collection:

<!-- ![Default MongoDB CRUD](img/MongoDB-Collection-default.png) -->

| Field         | Type     | Required | Nullable | Client-side Encryption | Description       |
| ------------- | -------- | -------- | -------- | ---------------------- | ----------------- |
| \_id          | ObjectId | Yes      | No       | No                     | The document id   |
| creatorId     | String   | Yes      | No       | No                     | The creator id    |
| createdAt     | Date     | Yes      | No       | No                     | The creation date |
| updaterId     | String   | Yes      | No       | No                     | The updater id    |
| updatedAt     | Date     | Yes      | No       | No                     | The update date   |
| \_\_STATE\_\_ | String   | Yes      | No       | No                     | The state         |

At this point, we can alter the DB schema by creating the required properties of your CRUD collection, in this case the one about the books. To do so, you can choose between 2 options:

- Manually adding the properties;
- Importing the properties from a JSON file.

### Option 1: Manually add CRUD collection fields

In order to create the fields manually, you must click on the **Add field** button.

In this interface you can add:

- **Name** (required): the name of the field;
- **Description**: the description of the field;
- **Type** (required): the type of the field. Accepted values are:
  - String, Number, Boolean, Date, GeoPoint, Object, Array of String, Array of Number, Array of Object, or ObjectId;
- **Required**: if the field is required;
- **Nullable**: if the field is nullable;
- **Client-side Encryption**: if the field use the client-side encryption;
- **Allow search on encrypted field**: if the encrypted field is searchable;
- **Sensitivity**: the GDPR sensitivity. Accepted values are:
  - Unclassified, Public, Confidential, Secret, Top Secret;
- **GDPR Description**: the GDPR description

At bottom you can select **"create Another"** to create another field after creating the one in progress.  
Once you have created all the needed fields you can create them clicking the **"Create"** button.

For this example we will create the following fields:

| Field         | Type    | Required | Nullable | Client-side Encryption | Description                    |
| ------------- | ------- | -------- | -------- | ---------------------- | ------------------------------ |
| author        | String  | Yes      | false    | No                     | author of the book             |
| language      | String  | Yes      | false    | No                     | language of the book           |
| title         | String  | Yes      | false    | No                     | title of the book              |
| published     | Boolean | Yes      | false    | No                     | the book it's published?       |
| salesForecast | Number  | No       | false    | No                     | expected number of copies sold |

After adding this fields, you can read the properties in the CRUD page:

![Fields to the CRUD collection](img/MongoDB-Collection-all-fields.png)

### Option 2: Import CRUD collection

The other option is to import the fields from a json file that is compliant with the CRUD schema. To do so:

1. Click **"Import fields from file"** button;
1. In the dialog select the right file, for this example you can download it from <a download target="_blank" href="/docs_files_to_download/tutorial/rest-api-tutorial-schema.json">Here</a>.

At this point, **you will have your CRUD collection** with exactly the same fields of the first one. You can decide to edit the new CRUD collection (adding or removing fields), to change the name, or to expose it using another endpoint.

<details><summary>Click to see the tutorial schema:</summary>
<p>

<SourceCodeBlock filePath="/docs_files_to_download/tutorial/rest-api-tutorial-schema.json" />

</p>
</details>

:::tip
You can import fields during the creation phase of a new CRUD Collection, by clicking on the "Import fields from file" button, as you can see in the image [here](/tutorial/rest_api/quick_rest_api.mdx#create-a-new-crud-collection).
In this case, it will be also possible to **verify that the loaded structure** is correct and consistent.
:::

:::tip
As you can se near the **"Import fields from file"** there is a **"Export to JSON"** that allows you to download the current CRUD schema for future imports!
:::

Once you have created all the needed file with your preferred method remember to save the changes!
You don't know how to do it? Take a look at [Mia-Platform handbook](/tutorial/console/console_handbook.md#save-changes)!

## Expose the CRUD using an endpoint

At this point you will need to **add an endpoint** to your newly created book CRUD to access it.

The required parameters to create a new endpoint are the following:

- **Base path**: `/books`
- **Type**: in the dropdown menu select `"CRUD"`
- **CRUD Base Path**: in the dropdown menu select `/books`

After you will have create the endpoint, **by clicking the `/books` in the left side you can open the endpoint detail**, including the section:

![Endpoint Detail](img/MongoDB-Collection-endpoint-detail.png)

Now you can save the branch and deploy.

From the **API portal you will find all the API specifications** that will allow you to read, write, edit, and delete the information on your CRUD collection.
You can perform some insertions using POST call and then try to read the data using the GET request.

:::caution
Remember that when reading, the GET API will only return data whose **STATE** is PUBLIC.  
Make sure you create the elements directly like this, or make it clear as a value when you make the POST call.
:::

Here you can find an **overview of the API Portal**:
![Endpoint Portal](img/MongoDB-Collection-endpoint-portal.png)

By **expanding a method**, you will find everything you need to make an call. In this case, for example, the POST call:
![Endpoint POST Portal](img/MongoDB-Collection-endpoint-portal-post.png)

## Try CRUD endpoints with API Portal

here
